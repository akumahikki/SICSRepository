<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>SICS IRT: src/estimation/classical/EMEstimation.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SICS IRT
   &#160;<span id="projectnumber">1.00</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_710615f1fcb70e449001c5bcbae9c23a.html">estimation</a></li><li class="navelem"><a class="el" href="dir_4b439b805c70a575a7e8132f79b58bc5.html">classical</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">EMEstimation.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="EMEstimation_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * EM.cpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: May 29, 2014</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: mirt</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="EMEstimation_8h.html">EMEstimation.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="util_8h.html">util/util.h</a>&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a942acb2a0dcbd99dbd2669d6743e0e51">   11</a></span>&#160;<a class="code" href="classEMEstimation.html#a942acb2a0dcbd99dbd2669d6743e0e51">EMEstimation::EMEstimation</a>() {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <a class="code" href="classEMEstimation.html#ad6086e6784a5c651e6d5ad45a0c84d11">iterations</a> = 100;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a> = NULL;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="classEMEstimation.html#a4ad566123ad607b791d56990f9dd096d">f</a> = NULL;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="classEMEstimation.html#a426db380391c487206521631156d7eb6">r</a> = NULL;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="classEMEstimation.html#a77ab33231a9baa8c5a2ceb48534137a0">logger</a> = NULL;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="classEMEstimation.html#abbabf603bb09b6338114dd53aef5bd8a">optim</a> = NULL;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="classEMEstimation.html#aaa1a979767c171c5d33ee1ac77838ac2">convergenceSignal</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="classEMEstimation.html#abbabf603bb09b6338114dd53aef5bd8a">optim</a> = <span class="keyword">new</span> <a class="code" href="classOptimizer.html">Optimizer</a>();</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;}</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a218c478d8b1b49c4ea9076ba30852c9d">   23</a></span>&#160;<a class="code" href="classEMEstimation.html#a218c478d8b1b49c4ea9076ba30852c9d">EMEstimation::~EMEstimation</a>() {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classEMEstimation.html#a4ad566123ad607b791d56990f9dd096d">f</a> != NULL) {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classEMEstimation.html#a4ad566123ad607b791d56990f9dd096d">f</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    }</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classEMEstimation.html#a426db380391c487206521631156d7eb6">r</a> != NULL) {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classEMEstimation.html#a426db380391c487206521631156d7eb6">r</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classEMEstimation.html#a77ab33231a9baa8c5a2ceb48534137a0">logger</a> != NULL) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classEMEstimation.html#a77ab33231a9baa8c5a2ceb48534137a0">logger</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classEMEstimation.html#abbabf603bb09b6338114dd53aef5bd8a">optim</a> != NULL) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classEMEstimation.html#abbabf603bb09b6338114dd53aef5bd8a">optim</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a6cd3ac7193ff9d5d92bd90b58da26e11">   40</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#a6cd3ac7193ff9d5d92bd90b58da26e11">EMEstimation::setModel</a>(<a class="code" href="classModel.html">Model</a>* <a class="code" href="classModel.html">Model</a>) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> q;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">int</span> It;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    this-&gt;<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a> = Model;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    q = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a19bf0ae24a594e5140fd4a765f951299">getDimensionModel</a>()-&gt;<a class="code" href="classDimensionModel.html#a37d2d9ab998a4e65628571e6144311f6">getLatentTraitSet</a>()-&gt;<a class="code" href="classLatentTraitSet.html#aed95a0c5c87256960ffb528ca491f2c0">getTheta</a>()-&gt;<a class="code" href="singletonMatrix.html#abe6a17af941c66a1cceade934996c696">nC</a>();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    It = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a378677890d8c2ef90efa88a4aa08555e">getItemModel</a>()-&gt;<a class="code" href="classItemModel.html#a7a93c60e346f4d80f265a4c9e083181d">countItems</a>();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classEMEstimation.html#a4ad566123ad607b791d56990f9dd096d">f</a> = <span class="keyword">new</span> <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>(1, q);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="classEMEstimation.html#a426db380391c487206521631156d7eb6">r</a> = <span class="keyword">new</span> <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>(q, It);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a1f773c655ba098b5d6c8269de00003c3">   54</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#a1f773c655ba098b5d6c8269de00003c3">EMEstimation::setInitialValues</a>(map&lt;<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90">Parameter</a>, <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>*&gt; parameterSet) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa13375bcd79d7c1afbde0a8f179f38cb">setParameterSet</a>(parameterSet);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a9e6a83bfa5f78ec1531f67538dc12f93">   66</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#a1f773c655ba098b5d6c8269de00003c3">EMEstimation::setInitialValues</a>(<span class="keywordtype">string</span> method) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">/*TODO</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">     * Possible methods</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">     * ANDRADE</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">     * OSPINA</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">     * RANDOM</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">     * The default method is OSPINA</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span>(!method.compare(<span class="stringliteral">&quot;RANDOM&quot;</span>)){</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        std::srand(std::time(0)); <span class="comment">// use current time as seed for random generator</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">int</span> items = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>]-&gt;nC();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i &lt; items ; i++){</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>])(0, i)= <a class="code" href="util_8h.html#ad72ab76eb01a5daa7b359f28817520f9">randomd</a>()*2;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="comment">//fill b</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>])(0, i)= <a class="code" href="util_8h.html#ad72ab76eb01a5daa7b359f28817520f9">randomd</a>()*4-2 ;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            <span class="comment">//fill c</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordtype">int</span> m = 4;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>])(0, i)= <a class="code" href="util_8h.html#ad72ab76eb01a5daa7b359f28817520f9">randomd</a>()*(2/(double)m);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            cout&lt;&lt;<span class="stringliteral">&quot;i : &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; a &quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                &lt;&lt;(*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>])(0, i)&lt;&lt;<span class="stringliteral">&quot; b &quot;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                &lt;&lt;(*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>])(0, i)&lt;&lt;<span class="stringliteral">&quot; c &quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                &lt;&lt;(*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>])(0, i)&lt;&lt;endl;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span>(!method.compare(<span class="stringliteral">&quot;ANDRADE&quot;</span>)){</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">//Andrade method</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">int</span> items = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>]-&gt;nC();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//sums of the patterns</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">int</span> totalscores = 0 ;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">int</span> *itemscores = <span class="keyword">new</span> <span class="keywordtype">int</span> [items];</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    memset(itemscores,0,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*items);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">double</span> *covariances = <span class="keyword">new</span> <span class="keywordtype">double</span> [items];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    memset(covariances,0,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*items);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">double</span> variance = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classPatternMatrix.html">PatternMatrix</a>* data = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classPatternMatrix.html">PatternMatrix</a> *<span class="keyword">&gt;</span>(<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a378677890d8c2ef90efa88a4aa08555e">getItemModel</a>()-&gt;<a class="code" href="classItemModel.html#a8521ea3f8f511e88d5257ff7591cd928">getDataset</a>());</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">double</span> Ni = (double)data-&gt;<a class="code" href="classPatternMatrix.html#afd88d101ed9a74ed78c94e3eb024e448">countIndividuals</a>();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">for</span> (data-&gt;<a class="code" href="classPatternMatrix.html#a636096859a24b38dd40623e581bcb460">resetIterator</a>(); !data-&gt;<a class="code" href="classPatternMatrix.html#ae005cb9835142294ed5cbad3c9ab6a0f">checkEnd</a>(); data-&gt;<a class="code" href="classPatternMatrix.html#a6b6ba61b62f8bfdba73531d47c64564b">iterate</a>()) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">double</span> df = (double)data-&gt;<a class="code" href="classPatternMatrix.html#ac5daa989c86d2120ea02fcf9453aadce">getCurrentFrequency</a>();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordtype">double</span> bs = (double)data-&gt;<a class="code" href="classPatternMatrix.html#a0b425a01da86b03bb6391048249865a6">getCurrentBitSet</a>().count();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i &lt; items ; i++){</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keywordflow">if</span>(data-&gt;<a class="code" href="classPatternMatrix.html#a0b425a01da86b03bb6391048249865a6">getCurrentBitSet</a>()[i]){</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                itemscores[i]+=df;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        totalscores += bs*df;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">//calculate variances and covariances</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">for</span> (data-&gt;<a class="code" href="classPatternMatrix.html#a636096859a24b38dd40623e581bcb460">resetIterator</a>(); !data-&gt;<a class="code" href="classPatternMatrix.html#ae005cb9835142294ed5cbad3c9ab6a0f">checkEnd</a>(); data-&gt;<a class="code" href="classPatternMatrix.html#a6b6ba61b62f8bfdba73531d47c64564b">iterate</a>()){</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">double</span> df = (double)data-&gt;<a class="code" href="classPatternMatrix.html#ac5daa989c86d2120ea02fcf9453aadce">getCurrentFrequency</a>();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">double</span> bs = (double)data-&gt;<a class="code" href="classPatternMatrix.html#a0b425a01da86b03bb6391048249865a6">getCurrentBitSet</a>().count();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i &lt; items ; i++){</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">if</span>(data-&gt;<a class="code" href="classPatternMatrix.html#a0b425a01da86b03bb6391048249865a6">getCurrentBitSet</a>()[i]){</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                covariances[i]+=((1-itemscores[i]/Ni)*(1-bs/items))*df;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        variance+=((bs-((double)totalscores/Ni))*(bs-((<span class="keywordtype">double</span>)totalscores/Ni)))*df;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    variance /= Ni;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i &lt; items ; i++){</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        covariances[i] /= (Ni-1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">//Now calculate the standard deviations for the sums and the items</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span>*stddevs = <span class="keyword">new</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> [items];</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    memset(stddevs,0,<span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">double</span>)*items);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span>*pearson = <span class="keyword">new</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> [items];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    memset(pearson,0,<span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">double</span>)*items);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span>*pis = <span class="keyword">new</span> <span class="keywordtype">long</span> <span class="keywordtype">double</span> [items];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    memset(pis,0,<span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">double</span>)*items);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i &lt; items ; i++){</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordtype">double</span> avg= totalscores/Ni;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            stddevs[i]=<a class="code" href="util_8h.html#a92c4bf8b44e9ce9753076d022dad6a7f">stdDev_bin</a>(itemscores[i],Ni,avg);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            pis[i]=itemscores[i]/Ni;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            pearson[i]=(covariances[i]/(stddevs[i]*std::sqrt(variance)));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="comment">//fill a sqrt(pCoef * pCoef / (1.0 - pCoef * pCoef));</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>])(0, i)= std::sqrt((pearson[i]*pearson[i])/(1/pearson[i]*pearson[i]));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="comment">//fill b</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>])(0, i)=<a class="code" href="util_8h.html#a9c48e0fd22b6546d8aae7692fa02d1d7">normalInverse</a>(pis[i]);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="comment">//fill c</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordtype">int</span> m = 4;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>])(0, i)= 1 / (double)m;<span class="comment">//TODO CHANGE BY CONSTANT FROM CONST.H FILE</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            cout&lt;&lt;<span class="stringliteral">&quot;i : &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; a &quot;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    &lt;&lt;(*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>])(0, i)&lt;&lt;<span class="stringliteral">&quot; b &quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    &lt;&lt;(*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>])(0, i)&lt;&lt;<span class="stringliteral">&quot; c &quot;</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    &lt;&lt;(*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>])(0, i)&lt;&lt;endl;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="classEMEstimation.html#afd00a80808f85581961d4d0ed2ce2a97">  164</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#afd00a80808f85581961d4d0ed2ce2a97">EMEstimation::stepE</a>() {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">     * What we need</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">     * q</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">     * a pattern iterator</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">     * item number</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">     * success probability matrix</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">     * thetas</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">     * weights</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">     * parameter set</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">//Dataset by patterns</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classPatternMatrix.html">PatternMatrix</a>* data =</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classPatternMatrix.html">PatternMatrix</a> *<span class="keyword">&gt;</span>(<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a378677890d8c2ef90efa88a4aa08555e">getItemModel</a>()-&gt;<a class="code" href="classItemModel.html#a8521ea3f8f511e88d5257ff7591cd928">getDataset</a>());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">//Pattern iterator is data-&gt;iterator</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">//Item number</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> items = data-&gt;<a class="code" href="classPatternMatrix.html#adaa3ade657d4ed832a359be5954d842b">countItems</a>();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">//Success probability matrix is obtained via pm-&gt;getProbability(int,int)</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classParameterModel.html">ParameterModel</a>* pm = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//Thetas</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* thetas =</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a19bf0ae24a594e5140fd4a765f951299">getDimensionModel</a>()-&gt;<a class="code" href="classDimensionModel.html#a37d2d9ab998a4e65628571e6144311f6">getLatentTraitSet</a>()-&gt;<a class="code" href="classLatentTraitSet.html#aed95a0c5c87256960ffb528ca491f2c0">getTheta</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">//Amount of nodes</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> q = thetas-&gt;<a class="code" href="singletonMatrix.html#abe6a17af941c66a1cceade934996c696">nC</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">//Weights</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* weights =</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a19bf0ae24a594e5140fd4a765f951299">getDimensionModel</a>()-&gt;<a class="code" href="classDimensionModel.html#a37d2d9ab998a4e65628571e6144311f6">getLatentTraitSet</a>()-&gt;<a class="code" href="classLatentTraitSet.html#a1f48623a0834d134df2ddea3892a5b11">getWeight</a>();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">//A Matrix</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* A = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">//B Matrix</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* B = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>];</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//C Matrix</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* C = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>];</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">//Auxiliar array for the nodes</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> faux[q];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">//Restart f and r to zero</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="classEMEstimation.html#a4ad566123ad607b791d56990f9dd096d">f</a>-&gt;<a class="code" href="singletonMatrix.html#af40e280112b61f6a37b54d2e5ef02e5b">reset</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classEMEstimation.html#a426db380391c487206521631156d7eb6">r</a>-&gt;<a class="code" href="singletonMatrix.html#af40e280112b61f6a37b54d2e5ef02e5b">reset</a>();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">//cout&lt;&lt;(* data)&lt;&lt;endl;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#ab6469058eb7c0bf5e14e5d5f2020c0bc">successProbability</a>();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">//cout&lt;&lt;(*pm-&gt;probabilityMatrix)&lt;&lt;endl&lt;&lt;&quot;pm&quot;&lt;&lt;endl;</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">//TODO CAREFULLY PARALLELIZE FOR</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">for</span> (data-&gt;<a class="code" href="classPatternMatrix.html#a636096859a24b38dd40623e581bcb460">resetIterator</a>(); !data-&gt;<a class="code" href="classPatternMatrix.html#ae005cb9835142294ed5cbad3c9ab6a0f">checkEnd</a>(); data-&gt;<a class="code" href="classPatternMatrix.html#a6b6ba61b62f8bfdba73531d47c64564b">iterate</a>()) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">//Initialize faux in 1 to later calculate the productory</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; q; k++) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            faux[k] = 1;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">//Calculate g*(k) for all the k&#39;s</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">//first calculate the P for each k and store it in the array f aux</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; q; k++) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">//Calculate the p (iterate over the items in the productory)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; items; i++) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="keywordtype">double</span> prob = pm-&gt;<a class="code" href="classParameterModel.html#ac706c102c88bb20f5d47e61eb8d5dc7e">getProbability</a>(k, i);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="comment">//cout&lt;&lt;data-&gt;getCurrentBitSet()[items-i-1];</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">if</span> (!data-&gt;<a class="code" href="classPatternMatrix.html#a0b425a01da86b03bb6391048249865a6">getCurrentBitSet</a>()[items - i - 1]) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    prob = 1 - prob;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                faux[k] = faux[k] * prob;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            }       <span class="comment">//cout&lt;&lt;endl;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="comment">//At this point the productory is calculated and faux[k] is equivalent to p(u_j,theta_k)</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="comment">//Now multiply by the weight</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            faux[k] = faux[k] * (*weights)(0, k);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">//cout&lt;&lt;(*weights);</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">//compute the total of the p*a&#39; (denominator of the g*)</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        sum = 0.0;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; q; k++) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            sum += faux[k];</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">//cout&lt;&lt;faux[k]&lt;&lt;&quot; &quot;;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }       <span class="comment">//cout&lt;&lt;&quot;Da sum ist : &quot;&lt;&lt;sum&lt;&lt;endl;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; q; k++) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            faux[k] = faux[k] / sum;    <span class="comment">//This is g*_j_k</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="comment">//if(k==0)cout&lt;&lt;faux[k]&lt;&lt;&quot;faux after div&quot;&lt;&lt;endl;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">//Multiply the f to the frequency of the pattern</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            faux[k] = ((<span class="keywordtype">long</span> double) data-&gt;<a class="code" href="classPatternMatrix.html#ac5daa989c86d2120ea02fcf9453aadce">getCurrentFrequency</a>()) * faux[k];</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="comment">//if(k==0)cout&lt;&lt;faux[k]&lt;&lt;&quot;faux after freq&quot;&lt;&lt;endl;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            (*f)(0, k) += faux[k];</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="comment">//if(k==0)cout&lt;&lt;(*f)(0,k)&lt;&lt;&quot;The f &quot;&lt;&lt;((long double) data-&gt;getCurrentFrequency())&lt;&lt;endl;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="comment">//Now selectively add the faux to the r</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; items; i++) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="keywordflow">if</span> (data-&gt;<a class="code" href="classPatternMatrix.html#a0b425a01da86b03bb6391048249865a6">getCurrentBitSet</a>()[items - i - 1]) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    (*r)(k, i) = (*<a class="code" href="classEMEstimation.html#a426db380391c487206521631156d7eb6">r</a>)(k, i) + faux[k];</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                } <span class="comment">// if</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            } <span class="comment">// for</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        } <span class="comment">// for</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">//cout&lt;&lt;(*r)&lt;&lt;endl;</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;} <span class="comment">//end E step</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a8884e863f820e4a1a5caf099dca2ce1b">  261</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#a8884e863f820e4a1a5caf099dca2ce1b">EMEstimation::stepM</a>() {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">//Step M implementation using the BFGS Algorithm</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">     * What we need</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">     * fptr the pointer to loglik</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">     * gprt the pointer to gradient</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">     * hessptr the pointer to hessian matrix calculatrix</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">     * args the a,b, and c</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">     * pars, the other parameters q and stuff</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">     * nargs, npars, sizes.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">//fptr</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    double (*fptr)(<span class="keywordtype">double</span>*, <span class="keywordtype">double</span>*, int, int);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    void (*gptr)(<span class="keywordtype">double</span>*, <span class="keywordtype">double</span>*, int, int, <span class="keywordtype">double</span>*);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    void (*hptr)(<span class="keywordtype">double</span>*, <span class="keywordtype">double</span>*, int, int, <span class="keywordtype">double</span>*);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    fptr = &amp;<a class="code" href="classThreePLModel.html#ae31380f753f4bc118788f9dbc93fe4af">ThreePLModel::logLikelihood</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    gptr = &amp;<a class="code" href="classThreePLModel.html#a6b86ab6fe2c11047723864ab95bd29da">ThreePLModel::gradient</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    hptr = NULL;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">//cout&lt;&lt;&quot;Address : &quot;&lt;&lt;&amp;gptr&lt;&lt;&quot; &quot;&lt;&lt;&amp;hptr&lt;&lt;endl;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">int</span> It = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a378677890d8c2ef90efa88a4aa08555e">getItemModel</a>()-&gt;<a class="code" href="classItemModel.html#a8521ea3f8f511e88d5257ff7591cd928">getDataset</a>()-&gt;<a class="code" href="classDataSet.html#acbd07a4d4acc27332ec4f323e600885a">countItems</a>();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">int</span> q = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a19bf0ae24a594e5140fd4a765f951299">getDimensionModel</a>()-&gt;<a class="code" href="classDimensionModel.html#a37d2d9ab998a4e65628571e6144311f6">getLatentTraitSet</a>()-&gt;<a class="code" href="classLatentTraitSet.html#aed95a0c5c87256960ffb528ca491f2c0">getTheta</a>()-&gt;<a class="code" href="singletonMatrix.html#abe6a17af941c66a1cceade934996c696">nC</a>();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">double</span> args[3 * It];</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">double</span> pars[2 + 2 * q + q * It];</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">int</span> nargs = 3 * It;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">int</span> npars = 2 + 2 * q + q * It;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">//filling args</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">int</span> nA = 0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// Obtain a</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">//A Matrix</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* A = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">//B Matrix</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* B = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>];</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//C Matrix</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* C = <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>];</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a> DA(*A);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a> DB(*B);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a> DC(*C);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; It; i++) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        args[nA] = (*A)(0, i);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        nA++;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// Obtain b</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; It; i++) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        args[nA] = (*B)(0, i);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        nA++;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// Obtain c</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; It; i++) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        args[nA] = (*C)(0, i);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        nA++;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">//Filling pars</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">int</span> nP = 0;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// Obtain q</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    pars[nP] = q;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    nP++;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// Obtain I</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    pars[nP] = It;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    nP++;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// Obtain theta</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">//Thetas</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="singletonMatrix.html">Matrix&lt;double&gt;</a>* thetas =</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a19bf0ae24a594e5140fd4a765f951299">getDimensionModel</a>()-&gt;<a class="code" href="classDimensionModel.html#a37d2d9ab998a4e65628571e6144311f6">getLatentTraitSet</a>()-&gt;<a class="code" href="classLatentTraitSet.html#aed95a0c5c87256960ffb528ca491f2c0">getTheta</a>();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; q; k++) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        pars[nP] = (*thetas)(0, k); <span class="comment">//TODO correct indexing on this and nearby matrices</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        nP++;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// Obtain f</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; q; k++) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        pars[nP] = (*f)(0, k);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        nP++;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// Obtain r</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; q; k++) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; It; i++) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            pars[nP] = (*r)(k, i);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            nP++;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    nargs = nA;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    npars = nP;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">     * Chooses the method</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">     * method 1 is NR</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">     * method 2 is BFGS</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">int</span> method = 2;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (method == 1) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment">//Newton Raphson</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordtype">double</span> grad[3 * It];</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordtype">double</span> hess[3 * 3 * It];</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <a class="code" href="classThreePLModel.html#a6b86ab6fe2c11047723864ab95bd29da">ThreePLModel::gradient</a>(args, pars, nargs, npars, grad);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <a class="code" href="classThreePLModel.html#a034561892349c03922d857a67d15f79d">ThreePLModel::Hessian</a>(args, pars, nargs, npars, hess);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; It; ++i) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordtype">double</span> targs[3];</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="comment">//fill the args for the item</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            targs[0] = args[i];</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            targs[1] = args[It + i];</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            targs[2] = args[2 * It + i];</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordtype">double</span> tgrad[3];</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordtype">double</span> thess[9];</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="comment">//Pass the item number through the tunnel in memory</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            tgrad[0] = It;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            thess[0] = It;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="comment">//Create the gradient pointer</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            void (*tgptr)(<span class="keywordtype">double</span>*, <span class="keywordtype">double</span>*, int, int, <span class="keywordtype">double</span>*);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            void (*thptr)(<span class="keywordtype">double</span>*, <span class="keywordtype">double</span>*, int, int, <span class="keywordtype">double</span>*);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            tgptr = &amp;<a class="code" href="classThreePLModel.html#a1e103a8afde4c931b15d451f131ebc6e">ThreePLModel::itemgradient</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            thptr = &amp;<a class="code" href="classThreePLModel.html#a4eb5d27957e207af988cfc87b1adbb27">ThreePLModel::itemHessian</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="comment">//optimize with these parameters changing the args</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            newton(tgptr, thptr, targs, hess, grad, 3, i, 100, tgrad, thess);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="comment">//cout&lt;&lt;&quot;Made it this far&quot;;</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="comment">//update the args</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            args[i] = targs[0];</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            args[It + i] = targs[1];</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            args[2 * It + i] = targs[2];</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (method == 2) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">//BFGS</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <a class="code" href="classEMEstimation.html#abbabf603bb09b6338114dd53aef5bd8a">optim</a>-&gt;<a class="code" href="classOptimizer.html#ab3c54cfddcd5e97c1dae4cc6bd4e4e92">searchOptimal</a>(fptr, gptr, hptr, args, pars, nargs, npars);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// Now pass the optimals to the Arrays.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    nA = 0;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// Obtain a</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; It; i++) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        (*A)(0, i) = args[nA++];</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">if</span> (fabs((*A)(0, i)) &gt; abs(10)) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            (*C)(0, i) = 0.852;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;A reset.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// Obtain b</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; It; i++) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        (*B)(0, i) = args[nA++];</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">if</span> (fabs((*B)(0, i)) &gt; abs(-50)) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            (*C)(0, i) = 0.5;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;B reset.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// Obtain c</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; It; i++) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        (*C)(0, i) = args[nA++];</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">if</span> (fabs((*C)(0, i)) &gt; abs(600)) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            (*C)(0, i) = -1.7364;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;C reset.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">//Boundary regularize the arguments</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//C = -1.7346</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//B = 0.5;</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">//A = 0.851</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">//Obtain the deltas</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">//Perform substracts</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordtype">double</span> maxDelta = 0;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordtype">double</span> meanDelta = 0;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">int</span> DeltaC = 0;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v1 = 0; v1 &lt; It; ++v1) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        DA(0, v1) = DA(0, v1) - (*A)(0, v1);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        DB(0, v1) = DB(0, v1) - (*B)(0, v1);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        DC(0, v1) = DC(0, v1) - (*C)(0, v1);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        meanDelta = +fabs(DA(0, v1));</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        meanDelta = +fabs(DB(0, v1));</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        meanDelta = +fabs(DC(0, v1));</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        DeltaC += 3;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">if</span> (fabs(DA(0, v1)) &gt; maxDelta) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            maxDelta = fabs(DA(0, v1));</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span> (fabs(DB(0, v1)) &gt; maxDelta) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            maxDelta = fabs(DB(0, v1));</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">if</span> (fabs(DC(0, v1)) &gt; maxDelta) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            maxDelta = fabs(DC(0, v1));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    meanDelta = meanDelta / DeltaC;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> (meanDelta &lt; 0.0001 and maxDelta &lt; 0.001) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <a class="code" href="classEMEstimation.html#aaa1a979767c171c5d33ee1ac77838ac2">convergenceSignal</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;Max Delta : &quot; &lt;&lt; maxDelta &lt;&lt; endl;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;Mean Delta : &quot; &lt;&lt; meanDelta &lt;&lt; endl;</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;MATS : &quot; &lt;&lt; endl &lt;&lt; (*A) &lt;&lt; (*B) &lt;&lt; (*C) &lt;&lt; endl;</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">//And set the parameter sets</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    map&lt;Parameter, Matrix&lt;double&gt; *&gt; parSet;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    parSet[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>] = A;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    parSet[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>] = B;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    parSet[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>] = C;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// llenar las tres matrices</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa13375bcd79d7c1afbde0a8f179f38cb">setParameterSet</a>(parSet);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;}</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a7391808764fd510d6a0f0351ec699b2d">  473</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#a7391808764fd510d6a0f0351ec699b2d">EMEstimation::estimate</a>() {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">     * TODO Estimate</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">//Transform B and C</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;Item impression&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a378677890d8c2ef90efa88a4aa08555e">getItemModel</a>()-&gt;<a class="code" href="classItemModel.html#a7a93c60e346f4d80f265a4c9e083181d">countItems</a>(); ++i) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordtype">double</span> qa = (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>])(0, i);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordtype">double</span> qb = (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>])(0, i);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordtype">double</span> qc = (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>])(0, i);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="comment">//(*model-&gt;getParameterModel()-&gt;getParameterSet()[d])(0,i)= -qb*qa;</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>])(0, i) = log(</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                qc / (1 - qc));</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="classEMEstimation.html#ad6086e6784a5c651e6d5ad45a0c84d11">iterations</a> = 0;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="classEMEstimation.html#aaa1a979767c171c5d33ee1ac77838ac2">convergenceSignal</a>) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Iteration &quot;</span> &lt;&lt; <a class="code" href="classEMEstimation.html#ad6086e6784a5c651e6d5ad45a0c84d11">iterations</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="classEMEstimation.html#afd00a80808f85581961d4d0ed2ce2a97">stepE</a>();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;____________________________________________________________________________&quot;&lt;&lt;endl;</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">//cout&lt;&lt;*model-&gt;getParameterModel()-&gt;getParameterSet()[a]</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">//    &lt;&lt;*model-&gt;getParameterModel()-&gt;getParameterSet()[d]</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">//    &lt;&lt;*model-&gt;getParameterModel()-&gt;getParameterSet()[c];</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="classEMEstimation.html#a8884e863f820e4a1a5caf099dca2ce1b">stepM</a>();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="classEMEstimation.html#ad6086e6784a5c651e6d5ad45a0c84d11">iterations</a>++;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classEMEstimation.html#ad6086e6784a5c651e6d5ad45a0c84d11">iterations</a> &gt; 200) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <a class="code" href="classEMEstimation.html#aaa1a979767c171c5d33ee1ac77838ac2">convergenceSignal</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            cout&lt;&lt;<span class="stringliteral">&quot;more than 200 iters, stopp&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">//Transform B</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">//Transform C</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a378677890d8c2ef90efa88a4aa08555e">getItemModel</a>()-&gt;<a class="code" href="classItemModel.html#a7a93c60e346f4d80f265a4c9e083181d">countItems</a>(); ++i) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordtype">double</span> qa = (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>])(0, i);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordtype">double</span> qb = (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>])(0, i);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordtype">double</span> qc = (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>])(0, i);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">//(*model-&gt;getParameterModel()-&gt;getParameterSet()[d])(0,i)= -qb/qa;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordtype">double</span> ec = exp(qc);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        (*<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>])(0, i) = ec</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                / (1 + ec);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    cout</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;___________________CONVERGENCE VALUES________________________&quot;</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            &lt;&lt; endl;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;       cout &lt;&lt; *<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a>]</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            &lt;&lt; *<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a>]</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            &lt;&lt; *<a class="code" href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">model</a>-&gt;<a class="code" href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">getParameterModel</a>()-&gt;<a class="code" href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">getParameterSet</a>()[<a class="code" href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a>]</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;______________________________________________________________&quot;</span>&lt;&lt;endl;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div>
<div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a482fdb64918b8e5d68e2f5091bef4b05">  522</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#a482fdb64918b8e5d68e2f5091bef4b05">EMEstimation::checkRunningConditions</a>() {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="classEMEstimation.html#aa599b89650be2a1f95c1a986af5755f2">  526</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#aa599b89650be2a1f95c1a986af5755f2">EMEstimation::setOptimizationAlgorithm</a>(<span class="keywordtype">string</span> algorithm) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}</div>
<div class="line"><a name="l00530"></a><span class="lineno"><a class="line" href="classEMEstimation.html#ae8d8d6a4f2874d0da59ae2f57f21750a">  530</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#ae8d8d6a4f2874d0da59ae2f57f21750a">EMEstimation::setTrace</a>(<span class="keywordtype">string</span> filename) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="classEMEstimation.html#aadb720a89ed634dff963c4d50970b249">  533</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classEMEstimation.html#ae8d8d6a4f2874d0da59ae2f57f21750a">EMEstimation::setTrace</a>(<a class="code" href="classTrace.html">Trace</a> trace) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="classEMEstimation.html#a939385baead6848507efd5949906f50b">  537</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classEMEstimation.html#a939385baead6848507efd5949906f50b">EMEstimation::getIterations</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="classEMEstimation.html#ad6086e6784a5c651e6d5ad45a0c84d11">iterations</a>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div>
<div class="ttc" id="classModel_html_ab6469058eb7c0bf5e14e5d5f2020c0bc"><div class="ttname"><a href="classModel.html#ab6469058eb7c0bf5e14e5d5f2020c0bc">Model::successProbability</a></div><div class="ttdeci">void successProbability()</div><div class="ttdef"><b>Definition:</b> <a href="Model_8cpp_source.html#l00051">Model.cpp:51</a></div></div>
<div class="ttc" id="classEMEstimation_html_a426db380391c487206521631156d7eb6"><div class="ttname"><a href="classEMEstimation.html#a426db380391c487206521631156d7eb6">EMEstimation::r</a></div><div class="ttdeci">Matrix&lt; double &gt; * r</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8h_source.html#l00064">EMEstimation.h:64</a></div></div>
<div class="ttc" id="classModel_html_a19bf0ae24a594e5140fd4a765f951299"><div class="ttname"><a href="classModel.html#a19bf0ae24a594e5140fd4a765f951299">Model::getDimensionModel</a></div><div class="ttdeci">DimensionModel * getDimensionModel()</div><div class="ttdef"><b>Definition:</b> <a href="Model_8cpp_source.html#l00027">Model.cpp:27</a></div></div>
<div class="ttc" id="classEMEstimation_html_a942acb2a0dcbd99dbd2669d6743e0e51"><div class="ttname"><a href="classEMEstimation.html#a942acb2a0dcbd99dbd2669d6743e0e51">EMEstimation::EMEstimation</a></div><div class="ttdeci">EMEstimation()</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00011">EMEstimation.cpp:11</a></div></div>
<div class="ttc" id="classPatternMatrix_html_adaa3ade657d4ed832a359be5954d842b"><div class="ttname"><a href="classPatternMatrix.html#adaa3ade657d4ed832a359be5954d842b">PatternMatrix::countItems</a></div><div class="ttdeci">int countItems() const </div><div class="ttdoc">Output operator. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatrix_8cpp_source.html#l00015">PatternMatrix.cpp:15</a></div></div>
<div class="ttc" id="classEMEstimation_html_a482fdb64918b8e5d68e2f5091bef4b05"><div class="ttname"><a href="classEMEstimation.html#a482fdb64918b8e5d68e2f5091bef4b05">EMEstimation::checkRunningConditions</a></div><div class="ttdeci">void checkRunningConditions()</div><div class="ttdoc">Check if all the conditions are met for running the model, can report an error to a logger...</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00522">EMEstimation.cpp:522</a></div></div>
<div class="ttc" id="classEMEstimation_html_ad7a5d7459c7c0632a1aa3917fd7f3ba0"><div class="ttname"><a href="classEMEstimation.html#ad7a5d7459c7c0632a1aa3917fd7f3ba0">EMEstimation::model</a></div><div class="ttdeci">Model * model</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8h_source.html#l00068">EMEstimation.h:68</a></div></div>
<div class="ttc" id="classThreePLModel_html_a6b86ab6fe2c11047723864ab95bd29da"><div class="ttname"><a href="classThreePLModel.html#a6b86ab6fe2c11047723864ab95bd29da">ThreePLModel::gradient</a></div><div class="ttdeci">static void gradient(double *, double *, int, int, double *)</div><div class="ttdef"><b>Definition:</b> <a href="ThreePLModel_8cpp_source.html#l00378">ThreePLModel.cpp:378</a></div></div>
<div class="ttc" id="classEMEstimation_html_a1f773c655ba098b5d6c8269de00003c3"><div class="ttname"><a href="classEMEstimation.html#a1f773c655ba098b5d6c8269de00003c3">EMEstimation::setInitialValues</a></div><div class="ttdeci">void setInitialValues(map&lt; Parameter, Matrix&lt; double &gt; * &gt; parameterSet)</div><div class="ttdoc">Sets the initial values for the estimation, use this for inputting a matrix as initial values...</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00054">EMEstimation.cpp:54</a></div></div>
<div class="ttc" id="classParameterModel_html_ac706c102c88bb20f5d47e61eb8d5dc7e"><div class="ttname"><a href="classParameterModel.html#ac706c102c88bb20f5d47e61eb8d5dc7e">ParameterModel::getProbability</a></div><div class="ttdeci">virtual double getProbability(int, int)=0</div></div>
<div class="ttc" id="ParameterModel_8h_html_a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0"><div class="ttname"><a href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90ae8f0ad1953249e38043d318b8f4400d0">d</a></div><div class="ttdef"><b>Definition:</b> <a href="ParameterModel_8h_source.html#l00019">ParameterModel.h:19</a></div></div>
<div class="ttc" id="classThreePLModel_html_a1e103a8afde4c931b15d451f131ebc6e"><div class="ttname"><a href="classThreePLModel.html#a1e103a8afde4c931b15d451f131ebc6e">ThreePLModel::itemgradient</a></div><div class="ttdeci">static void itemgradient(double *, double *, int, int, double *)</div><div class="ttdoc">In the item gradient and hessians these procedures take an already calculated hessian and gradient an...</div><div class="ttdef"><b>Definition:</b> <a href="ThreePLModel_8cpp_source.html#l00129">ThreePLModel.cpp:129</a></div></div>
<div class="ttc" id="classParameterModel_html_aa13375bcd79d7c1afbde0a8f179f38cb"><div class="ttname"><a href="classParameterModel.html#aa13375bcd79d7c1afbde0a8f179f38cb">ParameterModel::setParameterSet</a></div><div class="ttdeci">virtual void setParameterSet(map&lt; Parameter, Matrix&lt; double &gt; * &gt; parameterSet)=0</div></div>
<div class="ttc" id="singletonMatrix_html_af40e280112b61f6a37b54d2e5ef02e5b"><div class="ttname"><a href="singletonMatrix.html#af40e280112b61f6a37b54d2e5ef02e5b">Matrix::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">Create special kinds of matrices (dense identity) </div><div class="ttdef"><b>Definition:</b> <a href="Matrix_8h_source.html#l00182">Matrix.h:182</a></div></div>
<div class="ttc" id="classEMEstimation_html_abbabf603bb09b6338114dd53aef5bd8a"><div class="ttname"><a href="classEMEstimation.html#abbabf603bb09b6338114dd53aef5bd8a">EMEstimation::optim</a></div><div class="ttdeci">Optimizer * optim</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8h_source.html#l00070">EMEstimation.h:70</a></div></div>
<div class="ttc" id="classEMEstimation_html_aaa1a979767c171c5d33ee1ac77838ac2"><div class="ttname"><a href="classEMEstimation.html#aaa1a979767c171c5d33ee1ac77838ac2">EMEstimation::convergenceSignal</a></div><div class="ttdeci">bool convergenceSignal</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8h_source.html#l00072">EMEstimation.h:72</a></div></div>
<div class="ttc" id="classPatternMatrix_html"><div class="ttname"><a href="classPatternMatrix.html">PatternMatrix</a></div><div class="ttdoc">Class for holding binary matrices in the array of patterns of bitsets form. </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatrix_8h_source.html#l00020">PatternMatrix.h:20</a></div></div>
<div class="ttc" id="EMEstimation_8h_html"><div class="ttname"><a href="EMEstimation_8h.html">EMEstimation.h</a></div></div>
<div class="ttc" id="classParameterModel_html"><div class="ttname"><a href="classParameterModel.html">ParameterModel</a></div><div class="ttdef"><b>Definition:</b> <a href="ParameterModel_8h_source.html#l00021">ParameterModel.h:21</a></div></div>
<div class="ttc" id="classOptimizer_html"><div class="ttname"><a href="classOptimizer.html">Optimizer</a></div><div class="ttdoc">Wrapper for the other optimizers, take general functions for the function to optimize, the vector gradient function and the matrix hessian function The parameters are : double * args (Arguments over which the function optimizes) double * pars (Arguments in whose the function depends but are not optimized) int nargs Number of arguments int npars Number of parameters double * return (Return of the function is put in this array.) </div><div class="ttdef"><b>Definition:</b> <a href="Optimizer_8h_source.html#l00024">Optimizer.h:24</a></div></div>
<div class="ttc" id="ParameterModel_8h_html_a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63"><div class="ttname"><a href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90aa91fb0824da12f8bb3b74dd78fb13b63">a</a></div><div class="ttdef"><b>Definition:</b> <a href="ParameterModel_8h_source.html#l00019">ParameterModel.h:19</a></div></div>
<div class="ttc" id="classPatternMatrix_html_a6b6ba61b62f8bfdba73531d47c64564b"><div class="ttname"><a href="classPatternMatrix.html#a6b6ba61b62f8bfdba73531d47c64564b">PatternMatrix::iterate</a></div><div class="ttdeci">void iterate()</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatrix_8h_source.html#l00033">PatternMatrix.h:33</a></div></div>
<div class="ttc" id="classItemModel_html_a8521ea3f8f511e88d5257ff7591cd928"><div class="ttname"><a href="classItemModel.html#a8521ea3f8f511e88d5257ff7591cd928">ItemModel::getDataset</a></div><div class="ttdeci">virtual DataSet * getDataset()=0</div></div>
<div class="ttc" id="classDimensionModel_html_a37d2d9ab998a4e65628571e6144311f6"><div class="ttname"><a href="classDimensionModel.html#a37d2d9ab998a4e65628571e6144311f6">DimensionModel::getLatentTraitSet</a></div><div class="ttdeci">virtual LatentTraitSet * getLatentTraitSet() const =0</div></div>
<div class="ttc" id="classPatternMatrix_html_afd88d101ed9a74ed78c94e3eb024e448"><div class="ttname"><a href="classPatternMatrix.html#afd88d101ed9a74ed78c94e3eb024e448">PatternMatrix::countIndividuals</a></div><div class="ttdeci">int countIndividuals() const </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatrix_8cpp_source.html#l00020">PatternMatrix.cpp:20</a></div></div>
<div class="ttc" id="classItemModel_html_a7a93c60e346f4d80f265a4c9e083181d"><div class="ttname"><a href="classItemModel.html#a7a93c60e346f4d80f265a4c9e083181d">ItemModel::countItems</a></div><div class="ttdeci">virtual int countItems()=0</div></div>
<div class="ttc" id="classPatternMatrix_html_ae005cb9835142294ed5cbad3c9ab6a0f"><div class="ttname"><a href="classPatternMatrix.html#ae005cb9835142294ed5cbad3c9ab6a0f">PatternMatrix::checkEnd</a></div><div class="ttdeci">bool checkEnd()</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatrix_8h_source.html#l00032">PatternMatrix.h:32</a></div></div>
<div class="ttc" id="classTrace_html"><div class="ttname"><a href="classTrace.html">Trace</a></div><div class="ttdoc">Trace class for constructing execution and error logs onto files. </div><div class="ttdef"><b>Definition:</b> <a href="Trace_8h_source.html#l00023">Trace.h:23</a></div></div>
<div class="ttc" id="classThreePLModel_html_a034561892349c03922d857a67d15f79d"><div class="ttname"><a href="classThreePLModel.html#a034561892349c03922d857a67d15f79d">ThreePLModel::Hessian</a></div><div class="ttdeci">static void Hessian(double *args, double *pars, int nargs, int npars, double *Hessian)</div><div class="ttdef"><b>Definition:</b> <a href="ThreePLModel_8cpp_source.html#l00139">ThreePLModel.cpp:139</a></div></div>
<div class="ttc" id="classEMEstimation_html_aa599b89650be2a1f95c1a986af5755f2"><div class="ttname"><a href="classEMEstimation.html#aa599b89650be2a1f95c1a986af5755f2">EMEstimation::setOptimizationAlgorithm</a></div><div class="ttdeci">void setOptimizationAlgorithm(string algorithm)</div><div class="ttdoc">Sets the optimization algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00526">EMEstimation.cpp:526</a></div></div>
<div class="ttc" id="classEMEstimation_html_a218c478d8b1b49c4ea9076ba30852c9d"><div class="ttname"><a href="classEMEstimation.html#a218c478d8b1b49c4ea9076ba30852c9d">EMEstimation::~EMEstimation</a></div><div class="ttdeci">virtual ~EMEstimation()</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00023">EMEstimation.cpp:23</a></div></div>
<div class="ttc" id="util_8h_html"><div class="ttname"><a href="util_8h.html">util.h</a></div></div>
<div class="ttc" id="singletonMatrix_html_abe6a17af941c66a1cceade934996c696"><div class="ttname"><a href="singletonMatrix.html#abe6a17af941c66a1cceade934996c696">Matrix::nC</a></div><div class="ttdeci">int nC()</div><div class="ttdoc">Returns number of rows. </div><div class="ttdef"><b>Definition:</b> <a href="Matrix_8h_source.html#l00097">Matrix.h:97</a></div></div>
<div class="ttc" id="classEMEstimation_html_afd00a80808f85581961d4d0ed2ce2a97"><div class="ttname"><a href="classEMEstimation.html#afd00a80808f85581961d4d0ed2ce2a97">EMEstimation::stepE</a></div><div class="ttdeci">void stepE()</div><div class="ttdoc">Step E of the EM method, this step takes the actual estimation of the parameters, and produces a f an...</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00164">EMEstimation.cpp:164</a></div></div>
<div class="ttc" id="classModel_html"><div class="ttname"><a href="classModel.html">Model</a></div><div class="ttdoc">Model class that holds the structures for the IRT models can vary across parameters, items and dimensions includes suport for dichotomic and polytomic models multi and single dimensional models future suport for multiscale and longitudinal models can be implemented. </div><div class="ttdef"><b>Definition:</b> <a href="Model_8h_source.html#l00022">Model.h:22</a></div></div>
<div class="ttc" id="classOptimizer_html_ab3c54cfddcd5e97c1dae4cc6bd4e4e92"><div class="ttname"><a href="classOptimizer.html#ab3c54cfddcd5e97c1dae4cc6bd4e4e92">Optimizer::searchOptimal</a></div><div class="ttdeci">void searchOptimal(double(*functionPtr)(double *, double *, int, int), void(*gradientPtr)(double *, double *, int, int, double *), void(*HessianPtr)(double *, double *, int, int, double *), double *args, double *pars, int nargs, int npars)</div><div class="ttdef"><b>Definition:</b> <a href="Optimizer_8cpp_source.html#l00003">Optimizer.cpp:3</a></div></div>
<div class="ttc" id="classModel_html_a73fa05b38e29e6ec766ec1ddc6af99e4"><div class="ttname"><a href="classModel.html#a73fa05b38e29e6ec766ec1ddc6af99e4">Model::getParameterModel</a></div><div class="ttdeci">ParameterModel * getParameterModel()</div><div class="ttdef"><b>Definition:</b> <a href="Model_8cpp_source.html#l00043">Model.cpp:43</a></div></div>
<div class="ttc" id="util_8h_html_a92c4bf8b44e9ce9753076d022dad6a7f"><div class="ttname"><a href="util_8h.html#a92c4bf8b44e9ce9753076d022dad6a7f">stdDev_bin</a></div><div class="ttdeci">long double stdDev_bin(int tsum, int tN)</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00028">util.h:28</a></div></div>
<div class="ttc" id="classParameterModel_html_aa4e52819318c9dcc9087a36d1a940c0b"><div class="ttname"><a href="classParameterModel.html#aa4e52819318c9dcc9087a36d1a940c0b">ParameterModel::getParameterSet</a></div><div class="ttdeci">virtual map&lt; Parameter, Matrix&lt; double &gt; * &gt; getParameterSet()=0</div></div>
<div class="ttc" id="singletonMatrix_html"><div class="ttname"><a href="singletonMatrix.html">Matrix&lt; double &gt;</a></div></div>
<div class="ttc" id="classEMEstimation_html_a939385baead6848507efd5949906f50b"><div class="ttname"><a href="classEMEstimation.html#a939385baead6848507efd5949906f50b">EMEstimation::getIterations</a></div><div class="ttdeci">int getIterations() const </div><div class="ttdoc">Returns the iterations that took the estimation to obtain an answer. </div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00537">EMEstimation.cpp:537</a></div></div>
<div class="ttc" id="classEMEstimation_html_a6cd3ac7193ff9d5d92bd90b58da26e11"><div class="ttname"><a href="classEMEstimation.html#a6cd3ac7193ff9d5d92bd90b58da26e11">EMEstimation::setModel</a></div><div class="ttdeci">void setModel(Model *model)</div><div class="ttdoc">Sets the model to be estimated, currently only supports 3PL model. </div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00040">EMEstimation.cpp:40</a></div></div>
<div class="ttc" id="classEMEstimation_html_ae8d8d6a4f2874d0da59ae2f57f21750a"><div class="ttname"><a href="classEMEstimation.html#ae8d8d6a4f2874d0da59ae2f57f21750a">EMEstimation::setTrace</a></div><div class="ttdeci">void setTrace(string filename)</div><div class="ttdoc">Sets the reporter for the trace. </div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00530">EMEstimation.cpp:530</a></div></div>
<div class="ttc" id="classEMEstimation_html_a8884e863f820e4a1a5caf099dca2ce1b"><div class="ttname"><a href="classEMEstimation.html#a8884e863f820e4a1a5caf099dca2ce1b">EMEstimation::stepM</a></div><div class="ttdeci">void stepM()</div><div class="ttdoc">Executes the maximization step using the inputted or default optimizer currently only supporting BFGS...</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00261">EMEstimation.cpp:261</a></div></div>
<div class="ttc" id="classThreePLModel_html_a4eb5d27957e207af988cfc87b1adbb27"><div class="ttname"><a href="classThreePLModel.html#a4eb5d27957e207af988cfc87b1adbb27">ThreePLModel::itemHessian</a></div><div class="ttdeci">static void itemHessian(double *args, double *pars, int nargs, int npars, double *Hessian)</div><div class="ttdef"><b>Definition:</b> <a href="ThreePLModel_8cpp_source.html#l00115">ThreePLModel.cpp:115</a></div></div>
<div class="ttc" id="classEMEstimation_html_a77ab33231a9baa8c5a2ceb48534137a0"><div class="ttname"><a href="classEMEstimation.html#a77ab33231a9baa8c5a2ceb48534137a0">EMEstimation::logger</a></div><div class="ttdeci">Trace * logger</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8h_source.html#l00066">EMEstimation.h:66</a></div></div>
<div class="ttc" id="classModel_html_a378677890d8c2ef90efa88a4aa08555e"><div class="ttname"><a href="classModel.html#a378677890d8c2ef90efa88a4aa08555e">Model::getItemModel</a></div><div class="ttdeci">ItemModel * getItemModel()</div><div class="ttdef"><b>Definition:</b> <a href="Model_8cpp_source.html#l00035">Model.cpp:35</a></div></div>
<div class="ttc" id="ParameterModel_8h_html_a04ed5b8f1f3adf7af1d5092fae847e90"><div class="ttname"><a href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90">Parameter</a></div><div class="ttdeci">Parameter</div><div class="ttdef"><b>Definition:</b> <a href="ParameterModel_8h_source.html#l00019">ParameterModel.h:19</a></div></div>
<div class="ttc" id="classLatentTraitSet_html_a1f48623a0834d134df2ddea3892a5b11"><div class="ttname"><a href="classLatentTraitSet.html#a1f48623a0834d134df2ddea3892a5b11">LatentTraitSet::getWeight</a></div><div class="ttdeci">Matrix&lt; double &gt; * getWeight()</div><div class="ttdef"><b>Definition:</b> <a href="LatentTraitSet_8cpp_source.html#l00023">LatentTraitSet.cpp:23</a></div></div>
<div class="ttc" id="classLatentTraitSet_html_aed95a0c5c87256960ffb528ca491f2c0"><div class="ttname"><a href="classLatentTraitSet.html#aed95a0c5c87256960ffb528ca491f2c0">LatentTraitSet::getTheta</a></div><div class="ttdeci">Matrix&lt; double &gt; * getTheta()</div><div class="ttdef"><b>Definition:</b> <a href="LatentTraitSet_8cpp_source.html#l00015">LatentTraitSet.cpp:15</a></div></div>
<div class="ttc" id="classThreePLModel_html_ae31380f753f4bc118788f9dbc93fe4af"><div class="ttname"><a href="classThreePLModel.html#ae31380f753f4bc118788f9dbc93fe4af">ThreePLModel::logLikelihood</a></div><div class="ttdeci">static double logLikelihood(double *, double *, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="ThreePLModel_8cpp_source.html#l00510">ThreePLModel.cpp:510</a></div></div>
<div class="ttc" id="classPatternMatrix_html_ac5daa989c86d2120ea02fcf9453aadce"><div class="ttname"><a href="classPatternMatrix.html#ac5daa989c86d2120ea02fcf9453aadce">PatternMatrix::getCurrentFrequency</a></div><div class="ttdeci">long int getCurrentFrequency()</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatrix_8h_source.html#l00036">PatternMatrix.h:36</a></div></div>
<div class="ttc" id="classEMEstimation_html_a4ad566123ad607b791d56990f9dd096d"><div class="ttname"><a href="classEMEstimation.html#a4ad566123ad607b791d56990f9dd096d">EMEstimation::f</a></div><div class="ttdeci">Matrix&lt; double &gt; * f</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8h_source.html#l00063">EMEstimation.h:63</a></div></div>
<div class="ttc" id="ParameterModel_8h_html_a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a"><div class="ttname"><a href="ParameterModel_8h.html#a04ed5b8f1f3adf7af1d5092fae847e90a776304400122408ea717dde9234fdd2a">c</a></div><div class="ttdef"><b>Definition:</b> <a href="ParameterModel_8h_source.html#l00019">ParameterModel.h:19</a></div></div>
<div class="ttc" id="classPatternMatrix_html_a0b425a01da86b03bb6391048249865a6"><div class="ttname"><a href="classPatternMatrix.html#a0b425a01da86b03bb6391048249865a6">PatternMatrix::getCurrentBitSet</a></div><div class="ttdeci">boost::dynamic_bitset getCurrentBitSet()</div><div class="ttdef"><b>Definition:</b> <a href="PatternMatrix_8h_source.html#l00035">PatternMatrix.h:35</a></div></div>
<div class="ttc" id="classDataSet_html_acbd07a4d4acc27332ec4f323e600885a"><div class="ttname"><a href="classDataSet.html#acbd07a4d4acc27332ec4f323e600885a">DataSet::countItems</a></div><div class="ttdeci">virtual int countItems() const =0</div></div>
<div class="ttc" id="classPatternMatrix_html_a636096859a24b38dd40623e581bcb460"><div class="ttname"><a href="classPatternMatrix.html#a636096859a24b38dd40623e581bcb460">PatternMatrix::resetIterator</a></div><div class="ttdeci">void resetIterator()</div><div class="ttdoc">use this when reading in order </div><div class="ttdef"><b>Definition:</b> <a href="PatternMatrix_8h_source.html#l00031">PatternMatrix.h:31</a></div></div>
<div class="ttc" id="util_8h_html_ad72ab76eb01a5daa7b359f28817520f9"><div class="ttname"><a href="util_8h.html#ad72ab76eb01a5daa7b359f28817520f9">randomd</a></div><div class="ttdeci">double randomd()</div><div class="ttdoc">Functions part one Includes the next functions StdDev_bin : Calculates the standard deviation for a b...</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00022">util.h:22</a></div></div>
<div class="ttc" id="classEMEstimation_html_ad6086e6784a5c651e6d5ad45a0c84d11"><div class="ttname"><a href="classEMEstimation.html#ad6086e6784a5c651e6d5ad45a0c84d11">EMEstimation::iterations</a></div><div class="ttdeci">int iterations</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8h_source.html#l00074">EMEstimation.h:74</a></div></div>
<div class="ttc" id="classEMEstimation_html_a7391808764fd510d6a0f0351ec699b2d"><div class="ttname"><a href="classEMEstimation.html#a7391808764fd510d6a0f0351ec699b2d">EMEstimation::estimate</a></div><div class="ttdeci">void estimate()</div><div class="ttdoc">Main loop of the EM estimation orchestrates the parameters for the estimation, and holds the estimati...</div><div class="ttdef"><b>Definition:</b> <a href="EMEstimation_8cpp_source.html#l00473">EMEstimation.cpp:473</a></div></div>
<div class="ttc" id="util_8h_html_a9c48e0fd22b6546d8aae7692fa02d1d7"><div class="ttname"><a href="util_8h.html#a9c48e0fd22b6546d8aae7692fa02d1d7">normalInverse</a></div><div class="ttdeci">double normalInverse(double point)</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00042">util.h:42</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 16 2014 02:25:03 for SICS IRT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
